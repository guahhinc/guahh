<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guahh AI | v15 LLM CORE</title>
    <!-- Inter Tight Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d0d0d;
            --chat-bg: #141414;
            --input-bg: #1a1a1a;
            --text: #e0e0e0;
            --accent: #ffffff;
            --user-msg: #262626;
            --bot-msg: #141414;
            --border: #333;
        }
        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter Tight', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* HEADER */
        header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            background: rgba(13, 13, 13, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }
        h1 { margin: 0; font-size: 16px; font-weight: 600; letter-spacing: -0.5px; }
        .status { font-size: 12px; color: #666; font-weight: 300; }

        /* CHAT */
        #chat-window {
            flex: 1;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: 100px;
        }

        .msg {
            max-width: 90%;
            line-height: 1.6;
            font-size: 15px;
            font-weight: 300;
        }
        
        .user {
            align-self: flex-end;
            background: var(--user-msg);
            padding: 10px 15px;
            border-radius: 8px;
            color: #fff;
        }

        .bot {
            align-self: flex-start;
            color: #ccc;
        }

        .bot strong { color: #fff; font-weight: 600; }

        /* INPUT */
        #input-area {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: fixed;
            bottom: 0;
            left: 0; 
            right: 0;
            background: var(--bg);
        }
        
        form {
            display: flex;
            gap: 10px;
            background: var(--input-bg);
            padding: 5px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            padding: 12px;
            font-family: 'Inter Tight', sans-serif;
            font-size: 15px;
            outline: none;
        }

        button {
            background: var(--accent);
            color: black;
            border: none;
            padding: 0 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Inter Tight', sans-serif;
        }
        button:disabled { opacity: 0.5; cursor: wait; }

        /* Cursor Animation */
        .cursor {
            display: inline-block;
            width: 5px;
            height: 15px;
            background: var(--accent);
            margin-left: 2px;
            vertical-align: middle;
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>

<header>
    <h1>GUAHH AI v15</h1>
    <div class="status" id="model-status">Initializing LLM Weights...</div>
</header>

<div id="chat-window"></div>

<div id="input-area">
    <form onsubmit="event.preventDefault(); processPrompt();">
        <input type="text" id="user-input" placeholder="Message Guahh..." autocomplete="off">
        <button type="submit" id="send-btn">Send</button>
    </form>
</div>

<script>
/**
 * GUAHH AI V15 - LLM CORE
 * 
 * ARCHITECTURE:
 * 1. CORPUS: A massive text string containing all knowledge.
 * 2. TOKENIZER: Splits the corpus into a probabilistic map (Bigrams/Trigrams).
 * 3. INFERENCE: Generates the next word based on the previous word(s) in real-time.
 */

// --- 1. KNOWLEDGE CORPUS (The Brain) ---
// We treat this as one continuous stream of consciousness for the AI to learn patterns from.
const RAW_DATA = [
    "I am Guahh AI, a large language model running locally in your browser.",
    "Travis Scott is an American rapper, singer, songwriter, and record producer from Houston Texas. His albums include Rodeo, Astroworld, and Utopia. He founded Cactus Jack Records.",
    "Guahh is an Australian technology company based in Sydney. Guahh developed Kangaroo, a social media platform. Kangaroo combines features of Twitter and Instagram.",
    "Kangaroo is a social media website known for its hop feature. It was created by the tech giant Guahh.",
    "Biology is the study of life. Frogs are amphibians. Frogs absorb water through their skin. Sharks are marine predators with cartilage skeletons.",
    "Space is vast. The Sun is a star. Mars is the red planet. Jupiter is a gas giant. Black holes have infinite gravity.",
    "History records the past. World War 1 lasted from 1914 to 1918. World War 2 lasted from 1939 to 1945. The Roman Empire fell in 476 AD.",
    "Computer Science is the study of computation. Python is a programming language. JavaScript runs the web. AI stands for Artificial Intelligence.",
    "Math is the language of the universe. Pi is approximately 3.14. E is approximately 2.71. Gravity is 9.8 meters per second squared.",
    "The capital of France is Paris. The capital of Japan is Tokyo. The capital of Australia is Canberra.",
    "Music is art. Hip hop originated in New York. Jazz originated in New Orleans. Rock music uses electric guitars.",
    "Elon Musk runs Tesla and SpaceX. Bill Gates founded Microsoft. Steve Jobs founded Apple.",
    "Water is H2O. Oxygen is O2. Carbon is the basis of life.",
    "The internet connects the world. Blockchain is a decentralized ledger. Bitcoin is a cryptocurrency.",
    "Football is the most popular sport. LeBron James plays basketball. Messi plays soccer.",
    "Zeus is the Greek god of the sky. Thor is the Norse god of thunder. Hades rules the underworld.",
    "Supernovas are exploding stars. Neutron stars are dense. The speed of light is the universal speed limit.",
    "Git is a version control system. Docker uses containers. Linux is an open source kernel."
];

// --- 2. THE TOKENIZER & MODEL BUILDER ---
const MODEL = {};
const START_WORDS = [];

function trainModel() {
    let status = document.getElementById('model-status');
    status.innerText = "Training...";

    // Flatten data and clean it
    let fullText = RAW_DATA.join(" ");
    let tokens = fullText.split(/\s+/); // Split by whitespace

    for (let i = 0; i < tokens.length - 1; i++) {
        let current = clean(tokens[i]);
        let next = tokens[i+1]; // We keep punctuation in 'next' for natural flow

        if (!current) continue;

        // Record start words (words that start sentences)
        if (i === 0 || tokens[i-1].includes('.')) {
            START_WORDS.push(current);
        }

        if (!MODEL[current]) MODEL[current] = [];
        MODEL[current].push(next);
    }
    
    // Math Logic (Hardcoded Logic Gates)
    MODEL["MATH_GATE"] = true;

    status.innerText = `LLM Active: ${tokens.length} Parameters.`;
}

function clean(str) {
    return str.toLowerCase().replace(/[^\w]/g, "");
}

// --- 3. THE INFERENCE ENGINE (REAL-TIME WRITING) ---
const chatWindow = document.getElementById('chat-window');
const inputField = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');

async function processPrompt() {
    let prompt = inputField.value.trim();
    if (!prompt) return;

    // UI Handle
    addMessage(prompt, 'user');
    inputField.value = '';
    inputField.disabled = true;
    sendBtn.disabled = true;

    // Create Bot Message Container
    let botMsgDiv = document.createElement('div');
    botMsgDiv.className = 'msg bot';
    chatWindow.appendChild(botMsgDiv);
    
    // Add Cursor
    let cursor = document.createElement('span');
    cursor.className = 'cursor';
    botMsgDiv.appendChild(cursor);

    // --- THINKING PROCESS ---
    
    // 1. Context Search (RAG - Retrieval Augmented Generation)
    // We look for the most relevant sentence in our Raw Data to start the chain
    let bestSeed = findBestSeed(prompt);
    let outputQueue = [];
    
    if (isMath(prompt)) {
        outputQueue = solveMath(prompt).split(" ");
    } else if (bestSeed) {
        // We found a relevant fact. We will output it, but word by word.
        outputQueue = bestSeed.split(" ");
    } else {
        // Hallucination Mode (Pure Markov Generation)
        let seedWord = prompt.split(" ")[0] || "I";
        outputQueue = generateChain(seedWord, 15);
    }

    // --- WRITING PROCESS (Word by Word) ---
    for (let word of outputQueue) {
        // Insert word before cursor
        let textNode = document.createTextNode(word + " ");
        cursor.before(textNode);
        
        // Auto Scroll
        chatWindow.scrollTop = chatWindow.scrollHeight;
        
        // The "Thinking" Delay - Variable speed based on word length
        let delay = 30 + Math.random() * 50; 
        if (word.includes('.') || word.includes(',')) delay += 150; // Pause at punctuation
        
        await new Promise(r => setTimeout(r, delay));
    }

    // Finished
    cursor.remove();
    inputField.disabled = false;
    sendBtn.disabled = false;
    inputField.focus();
}

// --- UTILITIES ---

function findBestSeed(query) {
    let q = clean(query);
    // Score each sentence in RAW_DATA based on keyword matches
    let bestSentence = "";
    let highScore = 0;

    for (let sentence of RAW_DATA) {
        let score = 0;
        let words = sentence.split(" ");
        for (let w of words) {
            if (q.includes(clean(w)) && clean(w).length > 2) score++;
        }
        
        // Boost score for exact matches
        if (sentence.toLowerCase().includes(q)) score += 5;

        if (score > highScore) {
            highScore = score;
            bestSentence = sentence;
        }
    }

    if (highScore > 0) return bestSentence;
    return null;
}

function generateChain(startWord, length) {
    let chain = [];
    let current = clean(startWord);
    
    // If start word not in model, pick random start
    if (!MODEL[current]) current = clean(START_WORDS[Math.floor(Math.random() * START_WORDS.length)]);

    chain.push(current.charAt(0).toUpperCase() + current.slice(1)); // Capitalize first

    for(let i=0; i<length; i++) {
        let options = MODEL[current];
        if (!options || options.length === 0) break;
        
        let next = options[Math.floor(Math.random() * options.length)];
        chain.push(next);
        current = clean(next);
        
        if (next.includes('.')) break; // Stop at period
    }
    return chain;
}

function isMath(input) {
    return /[\d]/.test(input) && /[\+\-\*\/]/.test(input);
}

function solveMath(input) {
    try {
        let safe = input.replace(/[^\d\+\-\*\/\.\(\)]/g, "");
        let res = eval(safe);
        return `The calculated result is ${res}.`;
    } catch (e) {
        return "I could not calculate that.";
    }
}

function addMessage(text, type) {
    let div = document.createElement('div');
    div.className = `msg ${type}`;
    div.innerText = text;
    chatWindow.appendChild(div);
    chatWindow.scrollTop = chatWindow.scrollHeight;
}

// Boot
window.onload = () => {
    trainModel();
    // Simulate initial thought
    setTimeout(() => {
        let intro = document.createElement('div');
        intro.className = 'msg bot';
        intro.innerHTML = "<strong>Guahh AI Online.</strong> Waiting for input.";
        chatWindow.appendChild(intro);
    }, 500);
};

</script>
</body>
</html>
